<!DOCTYPE html>
<!--
* @file index.html
* @author Mikael Kindborg
*
* MoSync hybrid demo application that uses the jqMobi user interface framework.
-->
<html>
<head>
	<title>Twitter Reader</title>

	<meta http-equiv="Content-type" content="text/html; charset=utf-8"> 
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="jqmobi/icons.css" />
    <link rel="stylesheet" href="jqmobi/jq.ui.css" title="default" />
	<script src="jqmobi/jq.ui.min.js"></script>
   
	<script src="js/wormhole.js"></script>
	<script src="js/mosync.file.js"></script>
	<script src="js/mosync.mock.js"></script>
	<script src="js/app.js"></script>
	<script src="js/app.ui.js"></script>

	<script>
		/**
		 * Here we add jqMobi specific code.
		 */
		(function()
		{
			/**
			 * Show one page.
			 */
			app.ui.showPage = function(page)
			{
				console.log("@@@ app.ui.showPage: " + page);
				//$.ui.loadContent("#main",false,false,"up");
				$.ui.loadContent("#" + page, false, false, null);
			};

			/**
			 * Navigates back one page.
			 */
			app.ui.goBack = function()
			{
				console.log("@@@ app.ui.goBack");

				// Send the app to the background if
				// we are on the home screen (first page).
				//mosync.app.sendToBackground();
				//mosync.app.exit();
				$.ui.goBack();
				return false;
			};

			/**
			 * Called by framework when document has loaded.
			 */
			app.ui.initializeFramework = function()
			{
				// No special initialization is performed.
			};

			/**
			 * Diplay the list of favourite users in the UI.
			 * @param userData Array of user names.
			 */
			app.ui.displayFavouriteUsers = function(userData)
			{
				var users = app.parseFavouriteUsers(userData);
				var list = "";
				for (var i = 0; i < users.length; ++i)
				{
					list += "<li><a onclick='app.ui.showTweetsForUser(\"" +
						users[i] +
						"\")'>" +
						users[i] +
						"</a></li>";
				}
				$("#favouriteList").html(list);
				//$('#favouriteList').listview('refresh');
			};

			/**
			 * Displays the Twitter user name in the UI.
			 * @param user The Twitter user name.
			 */
			app.ui.showTweetListUserName = function(user)
			{
				$.ui.setTitle(user);
			};

			/**
			 * Displays a loading indicator in the UI.
			 */
			app.ui.showLoadingIndicator = function()
			{
				$.ui.setTitle("Loading...");
			};

			/**
			 * Outputs the list of tweets to the user-interface.
			 * @param tweets The tweets as an array. Each element
			 * represents one tweet and can be accessed via tweets[i].text
			 */
			app.ui.showTweetList = function(tweets)
			{
				var results = "";
				if ((!tweets) ||
					(tweets.length === 0) ||
					(tweets.error === "Not found"))
				{
					results = "<li>No tweets found</li>";
				}
				else
				{
					for (var i = 0; i < tweets.length; ++i)
					{
						results += "<li>" + tweets[i].text + "</li>";
					}
				}
				$("#tweetListContent").html(results);
				$("#tweetListContent").listview("refresh");
			};
		})();
	</script>
</head>

<body>
	<div id="jQUi">
		<div id="header">
			<!-- <h1 id="pageTitle">TwitterReader</h1>  -->
		</div>

		<div id="content">
			<div id="home" title="TwitterReader" class="panel" selected="true">
				<ul>
					<li>
						<input class="jq-ui-forms"
							onkeydown="app.ui.keydown(event.which)"
							type="text"
							id="userNameField"
							placeholder="User name"
							autocapitalize="off"
							autocorrect="off"
							autocomplete="off" />
					</li>
					<li><a onclick="app.ui.showTweets()">View Tweets by this user</a></li>
					<li><a onclick="app.ui.addFavouriteUser()">Add to Favourites</a></li>
				</ul>
				<hr/>
				<h2>Favourites</h2>
				<ul id="favouriteList">
					<li><a>(Empty)</a></li>
				</ul>
			</div>
			
			<div id="home" title="TweetList" class="panel" selected="false">
				<ul id="tweetListContent">
					<li>Loading...</li>
				</ul>
			</div>
		</div>
	</div>
</body>
</html>
